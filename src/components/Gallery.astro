---
// src/components/Gallery.astro
import { Image } from 'astro:assets';

interface ImageData {
  url: any;
  alt: string;
}

interface Props {
  images: ImageData[];
}

const { images } = Astro.props;

// Separamos la primera imagen para el diseño especial
const [firstImage, ...restOfImages] = images;
---

<section id="gallery-section" class="bg-brand-light py-24 px-4 overflow-hidden">
  <div class="max-w-6xl mx-auto">
    <div class="text-center mb-16 opacity-0 translate-y-10 transition-all duration-1000 ease-out anim-header">
      <h2 class="font-script text-brand-dark text-6xl md:text-7xl mb-4">Momentos</h2>
      <p class="font-serif text-brand-dark/70 italic text-lg">Un pedacito de mi historia</p>
      <div class="h-[1px] w-20 bg-brand/30 mx-auto mt-6"></div>
    </div>

    <div class="flex flex-col gap-4">
      {firstImage && (
        <div 
          class="w-full overflow-hidden rounded-2xl cursor-pointer group relative shadow-sm hover:shadow-xl transition-all duration-700 opacity-0 scale-90 translate-y-10 anim-photo"
          style="transition-delay: 150ms"
        >
          <Image 
            src={firstImage.url} 
            alt={firstImage.alt}
            width={1200} 
            height={800}
            class="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"
          />
          <div class="absolute inset-0 bg-brand-dark/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500 flex items-center justify-center">
             <span class="text-brand-light text-2xl font-serif italic">✨</span>
          </div>
        </div>
      )}

      <div class="grid grid-cols-2 gap-4">
        {restOfImages.map((img, index) => (
          <div 
            class="overflow-hidden rounded-2xl cursor-pointer group relative shadow-sm hover:shadow-xl transition-all duration-700 opacity-0 scale-90 translate-y-10 anim-photo"
            style={`transition-delay: ${ ((index + 1) % 6) * 150 }ms`} 
          >
            <Image 
              src={img.url} 
              alt={img.alt}
              width={800} 
              height={1200}
              class="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-brand-dark/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500 flex items-center justify-center">
               <span class="text-brand-light text-2xl font-serif italic">✨</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const header = entry.target.querySelector('.anim-header');
        if (header) {
          header.classList.remove('opacity-0', 'translate-y-10');
        }

        const photos = entry.target.querySelectorAll('.anim-photo');
        photos.forEach(photo => {
          photo.classList.remove('opacity-0', 'scale-90', 'translate-y-10');
          photo.classList.add('opacity-100', 'scale-100', 'translate-y-0');
        });

        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.05 });

  const section = document.getElementById('gallery-section');
  if (section) observer.observe(section);
</script>